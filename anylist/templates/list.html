{% extends "base.html" %}
{% block header %}
	<h1>{{ header }}</h1>
	{% include "components/filters.html" %}
	<img src="/static/glyphicons_158_show_lines.png" class="panel_display" onclick="show_panel()">
	{{ block.super }}
{% endblock %}
{% block content %}
	{% include "components/obj_list.html" %}
{% endblock %}
{% block navigation %}
	<div id="left_menu">
	{% include "components/raitings.html" %}
	{% include "components/genres.html" %}
	</div>
{% endblock %}

{% block script %}
	{{ block.super }}
	<script type="text/javascript">
		$(".add_me").click(function (eventObject) {
			var id = eventObject.target.parentElement.id.split("-")[0]
			$.ajax({
				url: "/mylist/add",
				data: {
					product: id
				},
				type: "POST"
			});
			eventObject.preventDefault();
		});
		$(".del_me").click(function (eventObject) {
			var id = eventObject.target.parentElement.id;
			console.log(id);
			$.post(
				window.location.pathname + id + "/remove_from_list"
			);
			eventObject.preventDefault();
		});
		// Изменение описания продукта
		$(".edit_me").click(function (eventObject) {
			{% comment %}Эта срань вычисляет url, на который мы перенаправимся,
			если нажмем на кнопку edit{% endcomment %}
			var id = eventObject.target.parentElement.parentElement.parentElement.href.split("/");
			id = id[id.length - 1];

			eventObject.preventDefault();
			window.location.pathname += id + "/edit";
		});
	</script>
{% endblock %}