<header>
	<h1>{{ header }}</h1>
	{% comment %}Меню в правом верхнем углу{% endcomment %}
	<section id="header_section">
		<input type="search" placeholder="Start enter name">
		<a href="/profile">{{ user.username }}</a>
		<img src="/static/show_main_menu.png" id="show_main_menu">
		{% if user.is_authenticated %}
			<button id="log_out">Log Out</button>
		{% else %}
			<button id="log_in">Log In</button>
		{% endif %}
	</section>
	<div id="start_auth"></div>
	<ul class="dropdown"></ul>
	
	{% comment %}Навигация по сайту (как в яндекс.островах){% endcomment %}
	<div class="global_nav" id="global_menu">
	{% for group in nav_groups %}
		<p>{{ group.name }}</p>
		<ul>
		{% for value in group.dashs %}
			<li>
				<a href="/{{ value.get_absolute_url }}" class="minified">
					<figure>
						<img src="{{ value.avatar_path }}">
						<figcaption>{{ value }}</figcaption>
					</figure>
				</a>
			</li>
		{% endfor %}
		</ul>
	{% endfor %}
	</div>
	{% comment %}Конец навигации по сайту{% endcomment %}
	<hr>
</header>

<script type="text/javascript">
	$("input[type='search']").keypress(function (eventObject) {
		if (!eventObject.ctrlKey && eventObject.key.length < 2 && !eventObject.shiftKey) {
			$.get(
				"/search",
				{ key:  eventObject.target.value + eventObject.key},
				function (data) {
					console.log(data);
					$(".dropdown").html("");
					for (var key in data) {
						$(".dropdown").append("<li><a href='" + data[key] + "'>" + key + "</a></li>");
					}
				}
			);
		}
	});
	authFormModule.render("#start_auth");
	authFormModule.hide();
	
	var url = window.location.pathname;
	var category = url.split("/");

	{% comment %}так мы определяем, что это шаблон list.html{% endcomment %}
	if ((category[1] != "profile" && !category[2]) || (category[2] == "filter"))  {
		$("#header_section").append("<img src='/static/right_menu.png' id='right_menu'>");
	}
	$("#log_in").click(function () {
		authFormModule.hide_else_show();
	});
	$("#log_out").click(function () {
		var url = window.location.pathname;
		if (url.endsWith("/"))
			window.location.pathname += "logout";
		else
			window.location.pathname += "/logout";
	});
	$("#show_main_menu").click(function () {
		var global_menu = $("#global_menu");
		if (global_menu.css("display") == "none")
			global_menu.css("display", "block");
		else
			global_menu.css("display", "none");
	});
</script>
