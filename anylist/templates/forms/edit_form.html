{% extends "base.html" %}
{% block head %}
<link rel="stylesheet" href="/static/select2/select2.css">
<script src="/static/jquery.min.js"></script>
<script src="/static/select2/select2.js"></script>
{% endblock %}
{% block header %}{{ header }}{% endblock %}
{% block title %}{{ header }}{% endblock %}
{% block body %}
<main>
	{% load wysiwyg %}
	{% wysiwyg_setup %}
	<form enctype="multipart/form-data" method="post" id="add_form">
			<input name="title" type="text" placeholder="Enter title here" class="form-title" value="{{ object.title }}" id="edit_title">
			<textarea class="form-textarea" rows="15" name="description" id="description">{{ object.description|safe }}</textarea>
			<div id="upload_form">
				<input type="file" name="avatar">
			</div>
		<div class="form-other">
			<select name="genres" id="genres" style="width:10em;" multiple>
			{% for genre in genres %}
				<option value="{{ genre.id }}">{{ genre.name }}</option>
			{% endfor %}
			</select>
			<input name="category" type="hidden" value="{{ category_id }}">
			<p></p>
		</div>
		<div>
			{% csrf_token %}
			<button type="submit">Next Step</button>
		</div>
	</form>
	{% wysiwyg_editor "description" %}
	</main>
{% endblock %}
{% block script %}
<script type="text/javascript">
	{% autoescape off %}
		var data = {{ use_genres }};
	{% endautoescape %}
	var preload_data = [];
	for (var i in data) {
		preload_data.push({id: '' + i, text: data[i]});	
	};
	$("#genres").select2({
		width: 400,
		placeholder: "Выберите жанры",
	});

	$("#add_form").attr("action", window.location.pathname);
</script>
{% endblock %}