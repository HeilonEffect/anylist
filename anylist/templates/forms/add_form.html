{% extends "base.html" %}
{% block header %}{{ header }}{% endblock %}
{% block title %}{{ header }}{% endblock %}
{% block body %}
<main ng-controller="AddFormCtrl">
	<form>
		<input type="text" ng-model="product.title">
		<textarea ng-model="product.description"></textarea>
		<input type="file" ng-model="product.avatar">
		<button ng-click="show_genres()">Add Genres</button>
		<div ng-show="visibility_genres">
			<ul ng-repeat-start="group in genre_groups">
				<li ng-repeat="genre in group.genres">{[{genre.name}]}</li>
			</ul>
			<div ng-repeat-end></div>
		</div>
		<input type="submit" value="Create">
	</form>
</main>
{% endblock %}
{% block script %}
<script>
	defaultApp.controller('AddFormCtrl', function ($scope, $http, $location) {
			$scope.visibility_genres = false;
			var category = window.location.pathname.split('/')[1];

			$scope.show_genres = function () {
				$scope.visibility_genres = !$scope.visibility_genres;
			}

			$http.get('/api/genres/category:' + category).success(function (data) {
				$scope.genre_groups = data;
			});
		}
	);
</script>
{% endblock %}